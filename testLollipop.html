<!DOCTYPE html>

<script src="https://d3js.org/d3.v6.min.js"></script>

<html>

    <body>
        <svg id="svg"></svg>
    </body>

</html>

<script>
    console.log(d3);

    let margin = {
        left: 60,
        top: 10,
        right: 10,
        bottom: 10
    };

    let height = 480 - margin.top - margin.bottom;
    let width = 640 - margin.left - margin.right;

    let svg = d3.select('#svg')
    .style('width', width + margin.left + margin.right)
    .style('height', height + margin.top + margin.bottom);

    let group = svg.append('g')
    .attr('transform', `translate(${margin.left},${margin.top})`);

    let testData = [
        {name: 'first', val: 1},
        {name: 'second', val: 2},
        {name: 'third', val: 3},
        {name: 'fourth', val: 4},
        {name: 'fifth', val: 5},
    ];

    function activateThirdLevel() {
        console.log("going to the next level!");
    }

    function createChart(data) {

        let xScale = d3.scaleBand()
        .range([0, width])
        .domain(data.map(d => d.name));

        let yScale = d3.scaleLinear()
        .domain([0, d3.max(data, (d) => { return d.val })])
        .range([height-margin.top, 0]);

        //create x axis
        svg.append('g')
        .attr('transform', `translate(${margin.left}, ${height})`)
        .call(d3.axisBottom(xScale));

        //create y axis
        svg.append('g')
        .attr('transform', `translate(${margin.left}, ${margin.top})`)
        .call(d3.axisLeft(yScale));

        group.selectAll('lolLine')
        .data(data)
        .enter()
        .append('line')
            .attr("x1", d => { return xScale(d.name) + margin.left-3; })
            .attr("x2", d => { return xScale(d.name) + margin.left-3; })
            .attr("y1", d => { return yScale(d.val); })
            .attr("y2", yScale(0))
            .attr('stroke', 'grey')
        
        group.selectAll('lolCircle')
        .data(data)
        .enter()
        .append('circle')
            .attr('cx', d => xScale(d.name) + margin.left-3)
            .attr('cy', d => yScale(d.val))
            .attr('r', 5)
            .style('fill', 'steelblue')
            .attr('stroke', 'black')
            .style('cursor', 'pointer')
            .on('mouseover', (event, d) => {
                d3.select(event.target).attr('opacity', 0.4)
            })
            .on('mouseout', (event, d) => {
                d3.select(event.target).attr('opacity', 1)
            })
            .on('mousedown', (event, d) => {
                activateThirdLevel();
            })

    }

    createChart(testData);


</script>

<style></style>